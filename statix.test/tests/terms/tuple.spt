module terms-tuple

language StatixTest

test unifying equal nullary tuples succeeds [[
  resolve () == ()
]] analysis succeeds
   run evaluate-test to SUCCEEDS()

test unifying equal binary tuples succeeds [[
  resolve (7, "x") == (7, "x")
]] analysis succeeds
   run evaluate-test to SUCCEEDS()

test unifying inequal binary tuples fails [[
  resolve (7, "int") == (8, "int")
]] analysis succeeds
   run evaluate-test to FAILS()

test equality on inequal arity tuples typing fails [[
  resolve (_, _, _) == (_, _)
]] analysis fails

test unifying unary tuple and value succeeds [[
  resolve (4) == 4
]] analysis succeeds
   run evaluate-test to SUCCEEDS()

test matching nullary tuple succeeds [[
  resolve c(())
  rules
    c : ()
    c(()).
]] analysis succeeds
   run evaluate-test to SUCCEEDS()

test matching binary tuple succeeds [[
  resolve c((1, 2))
  rules
    c : (int * int)
    c((1, 2)).
]] analysis succeeds
   run evaluate-test to SUCCEEDS()

test matching unary tuple against value succeeds [[
  resolve c((1))
  rules
    c : (int)
    c(1).
]] analysis succeeds
   run evaluate-test to SUCCEEDS()

test matching value against unary tuple succeeds [[
  resolve c(1)
  rules
    c : int
    c((1)).
]] analysis succeeds
   run evaluate-test to SUCCEEDS()
