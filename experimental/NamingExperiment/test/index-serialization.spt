module test-serialization 

language NamingExperiment

test Init
  index-setup(|"NamingExperiment", ["/tmp/test-serialization"]);
  index-clear;

  <index-add-all(|"/foo")> [Def([Def(), "newdef"])];
  
  <index-get-all> Def([Def(), "newdef"]) => [_]

test Init and reload
  index-setup(|"NamingExperiment", ["/tmp/test-serialization"]);
  index-clear;

  <index-add-all(|"/foo")> [Def([Def(), "newdef"])];
  index-commit;
  
  prim("LANG_index_setup", "NamingExperiment", ["/tmp/test-serialization2"]);  
  prim("LANG_index_setup", "NamingExperiment", ["/tmp/test-serialization"]);
  
  <index-get-all> Def([Def(), "newdef"]) => [_]

